apiVersion: v1
kind: ConfigMap
metadata:
  name: sentinel-config
  namespace: sentinel
data:
  NODE_ENV: 'production'
  REDIS_HOST: 'redis-master'
  REDIS_PORT: '6379'
  DATABASE_URL: 'postgresql://sentinel:sentinel@postgres:5432/sentinel'
  WEAVIATE_HOST: 'http://weaviate:8080'
  METRICS_PORT: '9090'
  LOG_LEVEL: 'info'
  SESSION_TTL: '86400'
  MAX_CONTEXTS: '1000'
---
apiVersion: v1
kind: Secret
metadata:
  name: sentinel-secrets
  namespace: sentinel
type: Opaque
stringData:
  OPENAI_API_KEY: 'sk-...'
  ANTHROPIC_API_KEY: 'sk-ant-...'
  DATABASE_URL: 'postgresql://sentinel:sentinel@postgres:5432/sentinel'
  JWT_SECRET: 'your-super-secret-jwt-key'
  ENCRYPTION_KEY: 'your-32-character-encryption-key'
---
apiVersion: v1
kind: PersistentVolumeClaim
metadata:
  name: sentinel-data
  namespace: sentinel
spec:
  accessModes:
    - ReadWriteOnce
  resources:
    requests:
      storage: 50Gi
---
apiVersion: v1
kind: PersistentVolumeClaim
metadata:
  name: sentinel-logs
  namespace: sentinel
spec:
  accessModes:
    - ReadWriteOnce
  resources:
    requests:
      storage: 10Gi
---
apiVersion: v1
kind: ServiceAccount
metadata:
  name: sentinel
  namespace: sentinel
---
apiVersion: rbac.authorization.k8s.io/v1
kind: Role
metadata:
  name: sentinel
  namespace: sentinel
rules:
  - apiGroups: ['']
    resources: ['pods', 'pods/logs']
    verbs: ['get', 'list', 'watch']
  - apiGroups: ['']
    resources: ['secrets']
    verbs: ['get']
  - apiGroups: ['']
    resources: ['configmaps']
    verbs: ['get', 'list']
---
apiVersion: rbac.authorization.k8s.io/v1
kind: RoleBinding
metadata:
  name: sentinel
  namespace: sentinel
subjects:
  - kind: ServiceAccount
    name: sentinel
    namespace: sentinel
roleRef:
  kind: Role
  name: sentinel
  apiGroup: rbac.authorization.k8s.io
